---
- name: Check if DPDK is already installed
  stat:
    path: /opt/dpdk/bin/dpdk-devbind.py
  register: dpdk_installed

- name: Include DPDK installation tasks
  include_tasks: install.yml
  when: not dpdk_installed.stat.exists

- name: Include IOMMU configuration
  include_tasks: iommu.yml

- name: Include hugepages configuration
  include_tasks: hugepages.yml

- name: Include NIC binding tasks
  include_tasks: bind_nic.yml
  when: dpdk_installed.stat.exists or dpdk_just_installed | default(false)
